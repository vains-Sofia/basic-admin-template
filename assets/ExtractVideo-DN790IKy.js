import{t as e}from"./debounce-Bnsqan9y.js";import"./use-aria-CMjMJ4AS.js";import"./_initCloneObject-BsjYyby-.js";import"./_baseClone-B5KGzugA.js";import{n as t,t as n}from"./css-1fkavuM7.js";import"./event-ybyaoC_m.js";import{n as r}from"./scroll-C0Dofiz-.js";import{i,t as a}from"./css-DENDHyzK.js";import"./use-deprecated-BP8lmVFH.js";import"./aria-CCaT2o1P.js";import{r as o,t as s}from"./teleport-DMHkh723.js";import{t as c}from"./css-BxD6NdqY.js";import{$r as l,B as u,Bt as d,Dt as f,E as p,Er as ee,Et as m,Fn as h,Fr as g,Ft as _,Gn as te,Gr as v,Gt as y,Ii as b,J as x,Jr as S,Jt as C,Li as w,Mi as T,Mr as ne,Nt as re,Qt as E,R as D,Ri as ie,Rr as O,Tr as k,Ur as A,Ut as ae,Vi as oe,Vr as se,X as j,Xr as ce,Y as M,_r as N,bi as le,br as P,bt as ue,c as F,d as I,dr as L,dt as de,fr as fe,gr as R,hr as pe,ii as me,ir as z,j as he,l as ge,mr as B,or as _e,ot as V,pr as H,q as ve,qi as U,qn as ye,qr as W,ri as G,u as K,ui as q,ur as J,v as be,vr as Y,vt as xe,xt as Se,y as Ce,yi as we,yt as X,z as Te}from"./index-DkS91mYz.js";/* empty css            *//* empty css            *//* empty css            */import{t as Ee}from"./request-CzSM6phE.js";var De=`Expected a function`;function Z(t,n,r){var i=!0,a=!0;if(typeof t!=`function`)throw TypeError(De);return h(r)&&(i=`leading`in r?!!r.leading:i,a=`trailing`in r?!!r.trailing:a),e(t,n,{leading:i,maxWait:n,trailing:a})}var Oe=Z,Q=xe({urlList:{type:X(Array),default:()=>I([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:X(String)}}),ke={close:()=>!0,error:e=>e instanceof Event,switch:e=>y(e),rotate:e=>y(e)},Ae=j(V(Y({...Y({name:`ElImageViewer`}),props:Q,emits:ke,setup(e,{expose:t,emit:n}){let r=e,i={CONTAIN:{name:`contain`,icon:l(he)},ORIGINAL:{name:`original`,icon:l(u)}},a,c=``,{t:d}=ue(),f=te(`image-viewer`),{nextZIndex:h}=Se(),_=G(),y=G(),S=ce(),C=J(()=>{let{scale:e,minScale:t,maxScale:n}=r;return re(e,t,n)}),w=G(!0),T=G(!1),E=G(r.initialIndex),k=me(i.CONTAIN),A=G({scale:C.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ae=G(r.zIndex??h()),j=J(()=>{let{urlList:e}=r;return e.length<=1}),le=J(()=>E.value===0),P=J(()=>E.value===r.urlList.length-1),F=J(()=>r.urlList[E.value]),I=J(()=>[f.e(`btn`),f.e(`prev`),f.is(`disabled`,!r.infinite&&le.value)]),pe=J(()=>[f.e(`btn`),f.e(`next`),f.is(`disabled`,!r.infinite&&P.value)]),ge=J(()=>{let{scale:e,deg:t,offsetX:n,offsetY:r,enableTransition:a}=A.value,o=n/e,s=r/e,c=t*Math.PI/180,l=Math.cos(c),u=Math.sin(c);o=o*l+s*u,s=s*l-n/e*u;let d={transform:`scale(${e}) rotate(${t}deg) translate(${o}px, ${s}px)`,transition:a?`transform .3s`:``};return k.value.name===i.CONTAIN.name&&(d.maxWidth=d.maxHeight=`100%`),d}),V=J(()=>`${E.value+1} / ${r.urlList.length}`);function U(){xe(),a?.(),document.body.style.overflow=c,n(`close`)}function Y(){let e=Oe(e=>{switch(e.code){case K.esc:r.closeOnPressEscape&&U();break;case K.space:Z();break;case K.left:ke();break;case K.up:$(`zoomIn`);break;case K.right:Ae();break;case K.down:$(`zoomOut`);break}}),t=Oe(e=>{$((e.deltaY||e.deltaX)<0?`zoomIn`:`zoomOut`,{zoomRate:r.zoomRate,enableTransition:!1})});S.run(()=>{m(document,`keydown`,e),m(document,`wheel`,t)})}function xe(){S.stop()}function we(){w.value=!1}function X(e){T.value=!0,w.value=!1,n(`error`,e),e.target.alt=d(`el.image.error`)}function Ee(e){if(w.value||e.button!==0||!_.value)return;A.value.enableTransition=!1;let{offsetX:t,offsetY:n}=A.value,r=e.pageX,i=e.pageY,a=Oe(e=>{A.value={...A.value,offsetX:t+e.pageX-r,offsetY:n+e.pageY-i}}),o=m(document,`mousemove`,a);m(document,`mouseup`,()=>{o()}),e.preventDefault()}function De(){A.value={scale:C.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Z(){if(w.value||T.value)return;let e=de(i),t=Object.values(i),n=k.value.name;k.value=i[e[(t.findIndex(e=>e.name===n)+1)%e.length]],De()}function Q(e){T.value=!1;let t=r.urlList.length;E.value=(e+t)%t}function ke(){le.value&&!r.infinite||Q(E.value-1)}function Ae(){P.value&&!r.infinite||Q(E.value+1)}function $(e,t={}){if(w.value||T.value)return;let{minScale:i,maxScale:a}=r,{zoomRate:o,rotateDeg:s,enableTransition:c}={zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0,...t};switch(e){case`zoomOut`:A.value.scale>i&&(A.value.scale=Number.parseFloat((A.value.scale/o).toFixed(3)));break;case`zoomIn`:A.value.scale<a&&(A.value.scale=Number.parseFloat((A.value.scale*o).toFixed(3)));break;case`clockwise`:A.value.deg+=s,n(`rotate`,A.value.deg);break;case`anticlockwise`:A.value.deg-=s,n(`rotate`,A.value.deg);break}A.value.enableTransition=c}function je(e){e.detail?.focusReason===`pointer`&&e.preventDefault()}function Me(){r.closeOnPressEscape&&U()}function Ne(e){if(e.ctrlKey&&(e.deltaY<0||e.deltaY>0))return e.preventDefault(),!1}return v(()=>C.value,e=>{A.value.scale=e}),v(F,()=>{ee(()=>{y.value?.complete||(w.value=!0)})}),v(E,e=>{De(),n(`switch`,e)}),ne(()=>{Y(),a=m(`wheel`,Ne,{passive:!1}),c=document.body.style.overflow,document.body.style.overflow=`hidden`}),t({setActiveItem:Q}),(e,t)=>(g(),fe(q(s),{to:`body`,disabled:!e.teleported},{default:W(()=>[N(ye,{name:`viewer-fade`,appear:``},{default:W(()=>[L(`div`,{ref_key:`wrapper`,ref:_,tabindex:-1,class:b(q(f).e(`wrapper`)),style:ie({zIndex:ae.value})},[N(q(o),{loop:``,trapped:``,"focus-trap-el":_.value,"focus-start-el":`container`,onFocusoutPrevented:je,onReleaseRequested:Me},{default:W(()=>[L(`div`,{class:b(q(f).e(`mask`)),onClick:z(t=>e.hideOnClickModal&&U(),[`self`])},null,10,[`onClick`]),H(` CLOSE `),L(`span`,{class:b([q(f).e(`btn`),q(f).e(`close`)]),onClick:U},[N(q(M),null,{default:W(()=>[N(q(p))]),_:1})],2),H(` ARROW `),q(j)?H(`v-if`,!0):(g(),B(_e,{key:0},[L(`span`,{class:b(q(I)),onClick:ke},[N(q(M),null,{default:W(()=>[N(q(be))]),_:1})],2),L(`span`,{class:b(q(pe)),onClick:Ae},[N(q(M),null,{default:W(()=>[N(q(Ce))]),_:1})],2)],64)),e.$slots.progress||e.showProgress?(g(),B(`div`,{key:1,class:b([q(f).e(`btn`),q(f).e(`progress`)])},[O(e.$slots,`progress`,{activeIndex:E.value,total:e.urlList.length},()=>[R(oe(q(V)),1)])],2)):H(`v-if`,!0),H(` ACTIONS `),L(`div`,{class:b([q(f).e(`btn`),q(f).e(`actions`)])},[L(`div`,{class:b(q(f).e(`actions__inner`))},[O(e.$slots,`toolbar`,{actions:$,prev:ke,next:Ae,reset:Z,activeIndex:E.value,setActiveItem:Q},()=>[N(q(M),{onClick:e=>$(`zoomOut`)},{default:W(()=>[N(q(x))]),_:1},8,[`onClick`]),N(q(M),{onClick:e=>$(`zoomIn`)},{default:W(()=>[N(q(ve))]),_:1},8,[`onClick`]),L(`i`,{class:b(q(f).e(`actions__divider`))},null,2),N(q(M),{onClick:Z},{default:W(()=>[(g(),fe(se(q(k).icon)))]),_:1}),L(`i`,{class:b(q(f).e(`actions__divider`))},null,2),N(q(M),{onClick:e=>$(`anticlockwise`)},{default:W(()=>[N(q(D))]),_:1},8,[`onClick`]),N(q(M),{onClick:e=>$(`clockwise`)},{default:W(()=>[N(q(Te))]),_:1},8,[`onClick`])])],2)],2),H(` CANVAS `),L(`div`,{class:b(q(f).e(`canvas`))},[T.value&&e.$slots[`viewer-error`]?O(e.$slots,`viewer-error`,{key:0,activeIndex:E.value,src:q(F)}):(g(),B(`img`,{ref_key:`imgRef`,ref:y,key:q(F),src:q(F),style:ie(q(ge)),class:b(q(f).e(`img`)),crossorigin:e.crossorigin,onLoad:we,onError:X,onMousedown:Ee},null,46,[`src`,`crossorigin`]))],2),O(e.$slots,`default`)]),_:3},8,[`focus-trap-el`])],6)]),_:3})]),_:3},8,[`disabled`]))}}),[[`__file`,`image-viewer.vue`]])),$=xe({hideOnClickModal:Boolean,src:{type:String,default:``},fit:{type:String,values:[``,`contain`,`cover`,`fill`,`none`,`scale-down`],default:``},loading:{type:String,values:[`eager`,`lazy`]},lazy:Boolean,scrollContainer:{type:X([String,Object])},previewSrcList:{type:X(Array),default:()=>I([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:X(String)}}),je={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>y(e),close:()=>!0,show:()=>!0};we();var Me=j(V(Y({...Y({name:`ElImage`,inheritAttrs:!1}),props:$,emits:je,setup(e,{expose:t,emit:n}){let a=e,{t:o}=ue(),s=te(`image`),c=A(),l=J(()=>E(Object.entries(c).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||[`id`,`style`].includes(e)))),u=i({excludeListeners:!0,excludeKeys:J(()=>Object.keys(l.value))}),p=G(),m=G(!1),h=G(!0),y=G(!1),x=G(),S=G(),re=_&&`loading`in HTMLImageElement.prototype,D,ie=J(()=>[s.e(`inner`),j.value&&s.e(`preview`),h.value&&s.is(`loading`)]),se=J(()=>{let{fit:e}=a;return _&&e?{objectFit:e}:{}}),j=J(()=>{let{previewSrcList:e}=a;return le(e)&&e.length>0}),ce=J(()=>{let{previewSrcList:e,initialIndex:t}=a,n=t;return t>e.length-1&&(n=0),n}),M=J(()=>a.loading===`eager`?!1:!re&&a.loading===`lazy`||a.lazy),N=()=>{_&&(h.value=!0,m.value=!1,p.value=a.src)};function F(e){h.value=!1,m.value=!1,n(`load`,e)}function I(e){h.value=!1,m.value=!0,n(`error`,e)}function de(e){e&&(N(),z())}let R=d(de,200,!0);async function me(){if(!_)return;await ee();let{scrollContainer:e}=a;if(ae(e))S.value=e;else if(T(e)&&e!==``)S.value=document.querySelector(e)??void 0;else if(x.value){let e=r(x.value);S.value=C(e)?void 0:e}let{stop:t}=f(x,([e])=>{R(e.isIntersecting)},{root:S});D=t}function z(){!_||!R||(D?.(),S.value=void 0,D=void 0)}function he(){j.value&&(y.value=!0,n(`show`))}function ge(){y.value=!1,n(`close`)}function V(e){n(`switch`,e)}return v(()=>a.src,()=>{M.value?(h.value=!0,m.value=!1,z(),me()):N()}),ne(()=>{M.value?me():N()}),t({showPreview:he}),(e,t)=>(g(),B(`div`,k({ref_key:`container`,ref:x},q(l),{class:[q(s).b(),e.$attrs.class]}),[m.value?O(e.$slots,`error`,{key:0},()=>[L(`div`,{class:b(q(s).e(`error`))},oe(q(o)(`el.image.error`)),3)]):(g(),B(_e,{key:1},[p.value===void 0?H(`v-if`,!0):(g(),B(`img`,k({key:0},q(u),{src:p.value,loading:e.loading,style:q(se),class:q(ie),crossorigin:e.crossorigin,onClick:he,onLoad:F,onError:I}),null,16,[`src`,`loading`,`crossorigin`])),h.value?(g(),B(`div`,{key:1,class:b(q(s).e(`wrapper`))},[O(e.$slots,`placeholder`,{},()=>[L(`div`,{class:b(q(s).e(`placeholder`))},null,2)])],2)):H(`v-if`,!0)],64)),q(j)?(g(),B(_e,{key:2},[y.value?(g(),fe(q(Ae),{key:0,"z-index":e.zIndex,"initial-index":q(ce),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"show-progress":e.showProgress,"url-list":e.previewSrcList,scale:e.scale,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:ge,onSwitch:V},pe({toolbar:W(t=>[O(e.$slots,`toolbar`,w(P(t)))]),default:W(()=>[e.$slots.viewer?(g(),B(`div`,{key:0},[O(e.$slots,`viewer`)])):H(`v-if`,!0)]),_:2},[e.$slots.progress?{name:`progress`,fn:W(t=>[O(e.$slots,`progress`,w(P(t)))])}:void 0,e.$slots[`viewer-error`]?{name:`viewer-error`,fn:W(t=>[O(e.$slots,`viewer-error`,w(P(t)))])}:void 0]),1032,[`z-index`,`initial-index`,`infinite`,`zoom-rate`,`min-scale`,`max-scale`,`show-progress`,`url-list`,`scale`,`crossorigin`,`hide-on-click-modal`,`teleported`,`close-on-press-escape`])):H(`v-if`,!0)],64)):H(`v-if`,!0)],16))}}),[[`__file`,`image.vue`]])),Ne={style:{"background-color":`var(--el-bg-color-page)`}},Pe={class:`p-5 mb-3`,style:{"background-color":`var(--el-bg-color)`}},Fe={class:`text-center`},Ie={key:0,class:`p-5 mb-3 text-center`,style:{"background-color":`var(--el-bg-color)`}},Le={key:1,class:`p-5 text-center mb-3`,style:{"background-color":`var(--el-bg-color)`}},Re=Y({__name:`ExtractVideo`,setup(e){let r=G(``),i=e=>e?[...e.matchAll(/https?:\/\/\S+/gi)].map(e=>e[0]).map(e=>e.replace(/[.,!?;:，。)）]+$/,``)):null,o=G(``),s=G(!1),l=G(),u=()=>{let e=i(r.value);e&&e.length>=1&&(o.value=e[0]),o.value?(s.value=!0,Ee.get(`https://competent-jilly-vains-0431fff4.koyeb.app/douyin/extract?shareUrl=${encodeURIComponent(o.value)}`,null,{rawResponse:!0}).then(e=>{e.error?F(e.error):l.value=e}).finally(()=>s.value=!1)):F(`请输入分享链接.`)};function d(e,t={}){let n=new URL(e,window.location.origin);for(let[e,r]of Object.entries(t))r==null?n.searchParams.delete(e):n.searchParams.set(e,r);return n.toString()}let f=e=>{l.value&&l.value.videoUrl?(e!==``&&(l.value.videoUrl=d(l.value.videoUrl,{ratio:e})),window.open(l.value.videoUrl,`_blank`,`noreferrer`)):F(`提取视频链接失败.`)};return(e,i)=>{let o=a,d=t,p=c,ee=n,m=Me,h=ge;return S((g(),B(`div`,Ne,[i[6]||=L(`div`,{class:`p-5 mb-3`,style:{"background-color":`var(--el-bg-color)`}},`视频提取`,-1),L(`div`,Pe,[L(`div`,Fe,[N(ee,{inline:``},{default:W(()=>[N(d,{class:`lg:w-[30%] w-[70%] mb-0!`},{default:W(()=>[N(o,{modelValue:r.value,"onUpdate:modelValue":i[0]||=e=>r.value=e,placeholder:`请输入分享内容`},null,8,[`modelValue`])]),_:1}),N(d,{class:`mr-0! mb-0!`},{default:W(()=>[N(p,{onClick:z(u,[`stop`])},{default:W(()=>[...i[3]||=[R(`提取`,-1)]]),_:1})]),_:1})]),_:1})])]),l.value?(g(),B(`div`,Ie,[N(p,{plain:``,onClick:i[1]||=e=>f(``)},{default:W(()=>[...i[4]||=[R(`预览(默认)`,-1)]]),_:1}),N(p,{plain:``,onClick:i[2]||=e=>f(`1080p`)},{default:W(()=>[...i[5]||=[R(`预览(1080p)`,-1)]]),_:1})])):H(``,!0),l.value?(g(),B(`div`,Le,[N(m,{src:l.value.videoCover,class:`md:h-[65vh]`},null,8,[`src`])])):H(``,!0)])),[[h,s.value]])}}});export{Re as default};